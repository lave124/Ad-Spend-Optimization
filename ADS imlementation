import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
data=pd.read_csv("C:\\Users\\lovish pc\\Machine+Learning+A-Z+(Codes+and+Datasets)\\Machine Learning A-Z (Codes and Datasets)\\Part 6 - Reinforcement Learning\\Section 32 - Upper Confidence Bound (UCB)\\Python\\Ads_CTR_Optimisation.csv")
print(data)

import math
N=10000 
# you can change the value of N rounds to 1000,500 or any other but 500 not give relvant output krke dekhle agr nai smj ara 500 set kr
d=10 # no of adds
ads_selected  =[] 
number_of_selections=[0]*d 

sum_of_rewards=[0]*d
total_reward=0 
for n in range(0,N):
    ad=0
    max_upper_bound=0
    for i in range(0,d):   
        if (number_of_selections[i]>0):
            average_reward=sum_of_rewards[i]/number_of_selections[i]
            delta_i=math.sqrt(3/2*math.log(n+1)/number_of_selections[i])
            upper_bound=average_reward+ delta_i
        else:
            upper_bound=1e400
           
        if upper_bound > max_upper_bound:
            max_upper_bound=upper_bound
            ad=i
            
    ads_selected.append(ad)
    number_of_selections[ad]=number_of_selections[ad] +1
    reward=data.values[n,ad]
    sum_of_rewards[ad]=sum_of_rewards[ad] +reward
    total_reward=total_reward+reward
    
    plt.hist(ads_selected)
plt.title("histogram of ads selections")
plt.xlabel("Ads")
plt.ylabel("no of times each ad was selected")
plt.show()
